## 概述
- 应用服务和数据服务分离
- 缓存(80%的业务访问集中在20%的数据上)
- 服务器集群(负载均衡调度服务器)
- 数据库读写分离(主从复制)
- 反向代理和CDN加速网站响应
  - CDN为从最近的网络提供商机房获取数据
  - 反向代理为如果反向代理服务器缓存着用户请求的资源就直接返回给用户
- 分布式文件系统(分布式数据库是数据库拆分的最后手段，一般用的是业务分库)
- 使用NoSQL和搜索引擎
- 业务拆分
- 分布式服务

## 网站架构模式
- 分层，比如应用层、服务层、数据层
- 分割
- 分布式：分布式是个**工作方式**
  - 分布式应用和服务
  - 分布式静态资源
  - 分布式数据和存储
  - 分布式计算
  - 分布式配置
  - 分布式锁
  - 分布式文件系统
- 集群：集群是个**物理形态**
- 缓存
  - CDN
  - 反向代理
  - 本地缓存
  - 分布式缓存
  - 使用前提：数据访问热点不均衡；数据在某个时间段内有效
- 异步
  - 解耦
  - 易扩展
  - 提高系统可用性
  - 加快网站响应速度
  - 消除并发访问高峰
- 冗余
  - 冷备份
  - 热备份
- 自动化
  - 自动化代码管理
  - 自动化测试
  - 自动化安全检测
  - 自动化部署
  - 自动化监控
  - 自动化报警
  - 自动化失效转移
  - 自动化失效恢复
  - 自动化降级
  - 自动化分配资源
  
## 架构要素
- 性能
- 可用性
- 伸缩性
- 扩展性
- 安全性

## 高性能
- 性能测试目标
  - 响应时间
  - 并发数
  - 吞吐量 TPS(每秒事务数) HPS(每秒HTTP请求书) QPS(每秒查询数)
  - 性能计数器：监控指标，报警异常
- 测试方法
  - 性能测试
  - 负载测试：性能最优压力
  - 压力测试：最大承受能力
  - 稳定性测试
 - web前端性能优化
  - 减少HTTP请求：合并JS CSS PICTURE
  - 使用浏览器缓存
  - 启用压缩
  - CSS放在最上面，JS放在页面最下面
  - 减少cookie

## 高可用
- 高可用应用
  - 负载均衡进行无状态服务的失效转移
  - Session集群
    - Session复制
    - Session绑定
    - Cookie记录Session
 - 高可用服务
  - 分级管理：对业务分优先级
  - 超时设置
  - 服务降级
  - 幂等性设计：保证重复调用结果一直
- 高可用数据
  - CAP原理：一个提供数据服务的存储系统无法同时满足CAP(数据一致性Consistency 数据可用性Avalibility 分区耐受性Patition Tolerance
    - 一般选择强化可用性A和伸缩性P，某种程度上放弃一致性C
    - 数据一致性：数据强一致、数据用户一致(访问时一致)、数据最终一致(调整自我恢复后一致)
  - 失效转移
    - 失效确认：心跳检测和应用程序访问失败报告
    - 访问转移
    - 数据恢复
    
## 安全架构
- XSS攻击（跨站脚本工具）
  - 分类
    - 反射型：诱导用户点击嵌入恶意脚本的链接
    - 持久型：恶意脚本存到数据库中，然后被包含在正常页面中
  - 防范
    - 转义
    - HttpOnly（禁止JS访问Cookie）
- 注入攻击
  - 分类
    - SQL注入攻击
    - OS注入攻击
  - CSRF攻击(跨站点请求位置)
    - 表达token
    - 验证码
    - Referer check
