## 大方向
- 优化服务器内核(由运维完成)
- 对MySQL的配置参数(my.cnf)进行优化，需要进行压力测试来进行参数调整
- 语句优化及表优化

## 参数优化
- 默认最大连接数`show variables like 'max_connections';`
- 查看当前访问Mysql的线程`show processlist`
- 设置最大连接数`set globle max_connections = 5000;`
- 查看当前被使用的connections `show globle status like 'max_user_connections'`

## 表优化
- 尽量小而精，字段尽量少
- 能用数字类型就不要用字符串类型
- 尽量避免null，null不方便查询优化，复合索引失效
- 图片等不要存DB，放到fastdfs中

## 语句优化
- 不要用select(*)
- 事务不能太大，否则不仅影响性能，还可能内存溢出
- update时where尽量走索引，不然会全表扫描(1G最少锁定10s）
- or尽量不用，改成in
- where里面不同字段or改成union `select a from A where b=1 union select a from A where c=1`
- 避免用count(*)，使用缓存或者单独的表来维护
- 避免"%s前缀"查询，会导致索引失效
- 尽量不用INSERT SELECT，数据量大有延迟，同步完了可能有错误
- UNION ALL而非UNION
- 分页时，`Select a from A limit 10000,10;`这种大偏移量效率低，
  - select a from A WHERE id\>=xxxx limit 11;(将上一页的最大值通过where id\> 进行预处理，然后分页)
  - select a from A WHERE id \>= ( select a from A limit 10000,1 ) limit 10;
  - select a from A inner join (select a from A limit 10000,10) using (id);
